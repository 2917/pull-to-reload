var PullToReload=function(a){var b=this;this.opts={"refresh-element":"ptr","content-element":"content","border-height":1,height:80,"font-size":"30px",threshold:20,"pre-content":"...","loading-content":"Loading...","callback-loading":function(){setTimeout(function(){b.loadingEnd()},1e3)}};for(var c in b.opts)void 0!==a[c]&&(b.opts[c]=a[c]);this.ptr=document.querySelector("#"+b.opts["refresh-element"]),this.content=document.querySelector("#"+b.opts["content-element"]),this.ptr.style.padding="0px",this.ptr.style.margin="0px",this.ptr.style.display="block",this.ptr.style.height=b.opts.height+"px",this.ptr.style.border=b.opts["border-height"]+"px solid #000",this.ptr.style.borderTop="0px",this.ptr.style.borderLeft="0px",this.ptr.style.borderRight="0px",this.ptr.style.textAlign="center",this.ptr.style.lineHeight=b.opts.height+"px",this.ptr.style.fontSize=b.opts["font-size"],this.ptr.style.marginTop="-"+(b.opts["border-height"]+b.opts.height)+"px",this.loadingStart=function(){this.ptr.innerHTML=b.opts["loading-content"],b.opts["callback-loading"]()},this.loadingEnd=function(){this.ptr.innerHTML=b.opts["pre-content"],this.ptr.style.marginTop="-"+(b.opts["border-height"]+b.opts.height+"px")},this.getPageY=function(a){if(void 0===a.pageY&&void 0!==a.touches){if(a.touches.length<=0)return!1;a.pageY=a.touches[a.touches.length-1].pageY}return a.pageY},this.isDragging=!1,this.isThresholdReached=!1,this.posStart=0,b.content.addEventListener("touchstart",function(a){b.mouseStart(a)}),b.content.addEventListener("mousedown",function(a){b.mouseStart(a)}),this.mouseStart=function(a){a.preventDefault(),a.stopImmediatePropagation(),b.isDragging=!0,b.isThresholdReached=!1,b.posStart=b.getPageY(a)},document.addEventListener("touchmove",function(a){b.mouseMove(a)}),document.addEventListener("mousemove",function(a){b.mouseMove(a)}),this.mouseMove=function(a){if(b.isDragging&&(a.preventDefault(),a.stopImmediatePropagation(),a.pageY=b.getPageY(a),a.pageY!==!1)){var c=a.pageY-b.posStart;if(!(c<=0)){var d=b.opts["border-height"]+(b.opts.height-c);d<=0||(d<=b.opts.threshold&&(b.isThresholdReached=!0),b.ptr.style.marginTop="-"+(d+"px"))}}},document.addEventListener("touchend",function(a){b.mouseEnd(a)}),document.addEventListener("mouseup",function(a){b.mouseEnd(a)}),this.mouseEnd=function(a){if(b.isDragging){if(a.preventDefault(),a.stopImmediatePropagation(),b.isThresholdReached)return b.ptr.style.marginTop="0px",b.isDragging=!1,b.isThresholdReached=!1,void b.loadingStart();b.ptr.style.marginTop="-"+(b.opts["border-height"]+b.opts.height+"px"),b.isDragging=!1,b.isThresholdReached=!1}}};
